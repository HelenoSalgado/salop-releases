# Maintainer: Bereia Verse <contato@instituto.org>
pkgname=bereia-verse
pkgver=0.0.0
pkgrel=1
pkgdesc="Bereia Verse Desktop App"
arch=('x86_64')
url="https://github.com/Instituto-Reformado-Santo-Evangelho/bereia-verse"
license=('Custom')
depends=('java-runtime>=17' 'glibc')
options=('!strip')
source=('BereiaVerse.desktop') # O ícone será copiado dinamicamente no CI
md5sums=('SKIP')

package() {
    local _appdir="$srcdir/app"
    local _destdir="$pkgdir/opt/$pkgname"

    # 1. Instalar Arquivos da Aplicação
    mkdir -p "$_destdir"
    cp -r "$_appdir"/* "$_destdir/"

    # 2. Link Simbólico para o Binário
    mkdir -p "$pkgdir/usr/bin"
    ln -s "/opt/$pkgname/bin/verse" "$pkgdir/usr/bin/$pkgname"

    # 3. Instalar arquivo .desktop
    install -Dm644 "$srcdir/BereiaVerse.desktop" "$pkgdir/usr/share/applications/$pkgname.desktop"

    # 4. Instalar Ícone (se existir na raiz do build_arch)
    if [ -f "$srcdir/bereia-verse.png" ]; then
        install -Dm644 "$srcdir/bereia-verse.png" "$pkgdir/usr/share/pixmaps/bereia-verse.png"
    fi
}