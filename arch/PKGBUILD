# Maintainer: Bereia Verse <contato@instituto.org>
pkgname=bereia-verse
pkgver=0.0.0
pkgrel=1
pkgdesc="Bereia Verse Desktop App"
arch=('x86_64')
url="https://github.com/Instituto-Reformado-Santo-Evangelho/bereia-verse"
license=('Custom')
depends=('java-runtime>=17' 'glibc')
options=('!strip')

package() {
    local _appdir="$srcdir/app"
    local _destdir="$pkgdir/opt/$pkgname"

    # 1. Instalar Arquivos da Aplicação
    mkdir -p "$_destdir"
    cp -r "$_appdir"/* "$_destdir/"

    # 2. Link Simbólico para o Binário
    mkdir -p "$pkgdir/usr/bin"
    ln -s "/opt/$pkgname/bin/bereiaverse" "$pkgdir/usr/bin/$pkgname"

    # 3. Instalar arquivo .desktop
    # O arquivo é copiado para o srcdir pelo CI
    install -Dm644 "$srcdir/bereiaverse.desktop" "$pkgdir/usr/share/applications/$pkgname.desktop"

    # 4. Instalar Ícone (se existir no srcdir)
    if [ -f "$srcdir/bereiaverse.png" ]; then
        install -Dm644 "$srcdir/bereiaverse.png" "$pkgdir/usr/share/pixmaps/bereiaverse.png"
    fi
}